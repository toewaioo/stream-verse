import{r as o,a as c,d as u,j as a}from"./app-BEzgBsru.js";import{L as f}from"./Loader-Dc-dTTXH.js";function b({user:n}){const r=o.useRef(!1),[p,d]=o.useState([]),[g,s]=o.useState("Initializing..."),e=(t,i="info")=>{const l=new Date().toLocaleTimeString();d(m=>[...m,{timestamp:l,message:t,type:i}]),console.log(`[${l}] ${t}`)};return o.useEffect(()=>{if(e("TgAuth page mounted","info"),e(`User authenticated: ${!!n}`,"info"),window.Telegram?.WebApp){const t=window.Telegram.WebApp;if(e("Telegram WebApp detected","success"),e(`initData present: ${!!t.initData}`,"info"),t.initData&&e(`initData: ${t.initData.substring(0,50)}...`,"info"),t.ready(),e("Telegram WebApp ready","success"),n){e("User already authenticated, redirecting to home...","success"),s("Already logged in! Redirecting..."),setTimeout(()=>{c.visit(route("home"))},1500);return}!n&&t.initData&&!r.current?(r.current=!0,s("Authenticating with Telegram..."),e("Attempting to login via Mini App...","info"),u.post(route("auth.telegram.mini-app"),{initData:t.initData}).then(i=>{e("Login successful!","success"),e(`Response: ${JSON.stringify(i.data)}`,"info"),s("Login successful! Redirecting to home..."),setTimeout(()=>{c.visit(route("home"))},1500)}).catch(i=>{e("Login failed!","error"),s("Authentication failed"),i.response?(e(`Error status: ${i.response.status}`,"error"),e(`Error data: ${JSON.stringify(i.response.data)}`,"error")):i.request?e("No response received from server","error"):e(`Error: ${i.message}`,"error"),r.current=!1})):t.initData?r.current&&e("Login already attempted","info"):(e("No initData available - cannot authenticate","warning"),s("No Telegram data available"))}else e("Not running in Telegram WebApp environment","warning"),s("Not a Telegram Mini App"),setTimeout(()=>{e("Redirecting to home page...","info"),c.visit(route("home"))},3e3)},[n]),a.jsx("div",{className:"min-h-screen bg-[#050505] text-white flex items-center justify-center p-6",children:a.jsxs("div",{className:"w-full max-w-2xl",children:[a.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 rounded-lg shadow-2xl p-8 mb-6 border border-gray-700",children:[a.jsx("div",{className:"flex items-center justify-center mb-6",children:a.jsx(f,{title:"Telegram Authentication",status:g})}),n&&a.jsxs("div",{className:"text-center text-sm text-green-400",children:["âœ“ Logged in as: ",n.name||n.email]})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx("button",{onClick:()=>c.visit(route("home")),className:"px-6 py-3 bg-white text-black font-bold uppercase tracking-widest hover:bg-gray-200 transition-colors rounded",children:"Go to Home"})})]})})}export{b as default};
