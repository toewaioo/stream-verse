import{r as o,a as c,d as p,j as s}from"./app-mlyWBNkP.js";function x({user:n}){const r=o.useRef(!1),[l,m]=o.useState([]),[f,i]=o.useState("Initializing..."),e=(t,a="info")=>{const d=new Date().toLocaleTimeString();m(u=>[...u,{timestamp:d,message:t,type:a}]),console.log(`[${d}] ${t}`)};o.useEffect(()=>{if(e("TgAuth page mounted","info"),e(`User authenticated: ${!!n}`,"info"),window.Telegram&&window.Telegram.WebApp){const t=window.Telegram.WebApp;if(e("Telegram WebApp detected","success"),e(`initData present: ${!!t.initData}`,"info"),t.initData&&e(`initData: ${t.initData.substring(0,50)}...`,"info"),t.ready(),e("Telegram WebApp ready","success"),n){e("User already authenticated, redirecting to home...","success"),i("Already logged in! Redirecting..."),setTimeout(()=>{c.visit(route("home"))},1500);return}!n&&t.initData&&!r.current?(r.current=!0,i("Authenticating with Telegram..."),e("Attempting to login via Mini App...","info"),p.post(route("auth.telegram.mini-app"),{initData:t.initData}).then(a=>{e("Login successful!","success"),e(`Response: ${JSON.stringify(a.data)}`,"info"),i("Login successful! Redirecting to home..."),setTimeout(()=>{c.visit(route("home"))},1500)}).catch(a=>{e("Login failed!","error"),i("Authentication failed"),a.response?(e(`Error status: ${a.response.status}`,"error"),e(`Error data: ${JSON.stringify(a.response.data)}`,"error")):a.request?e("No response received from server","error"):e(`Error: ${a.message}`,"error"),r.current=!1})):t.initData?r.current&&e("Login already attempted","info"):(e("No initData available - cannot authenticate","warning"),i("No Telegram data available"))}else e("Not running in Telegram WebApp environment","warning"),i("Not a Telegram Mini App"),setTimeout(()=>{e("Redirecting to home page...","info"),c.visit(route("home"))},3e3)},[n]);const g=t=>{switch(t){case"success":return"text-green-400";case"error":return"text-red-400";case"warning":return"text-yellow-400";default:return"text-gray-300"}};return s.jsx("div",{className:"min-h-screen bg-[#050505] text-white flex items-center justify-center p-6",children:s.jsxs("div",{className:"w-full max-w-2xl",children:[s.jsxs("div",{className:"bg-gray-900 rounded-lg shadow-xl p-6 border border-gray-700",children:[s.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[s.jsx("span",{className:"mr-2",children:"ðŸ”§"}),"Developer Logs"]}),s.jsx("div",{className:"bg-black rounded-md p-4 max-h-96 overflow-y-auto font-mono text-sm",children:l.length===0?s.jsx("p",{className:"text-gray-500",children:"No logs yet..."}):l.map((t,a)=>s.jsxs("div",{className:`mb-2 ${g(t.type)}`,children:[s.jsxs("span",{className:"text-gray-500 mr-2",children:["[",t.timestamp,"]"]}),s.jsx("span",{children:t.message})]},a))})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx("button",{onClick:()=>c.visit(route("home")),className:"px-6 py-3 bg-white text-black font-bold uppercase tracking-widest hover:bg-gray-200 transition-colors rounded",children:"Go to Home"})})]})})}export{x as default};
