import{r as f,j as e,u as j,R as b}from"./app-B9JngPTK.js";function v({ratingAverage:t,ratingCount:s,userRating:g,onRate:c}){const[o,m]=f.useState(0),[a,u]=f.useState(g?.rating||0),h=i=>{u(i),c&&c(i)},l=(i,d=!1)=>[...Array(5)].map((p,x)=>{const n=x+1;let r;if(d){const y=o>0?o:a/2;r=n<=Math.ceil(y)}else r=n<=Math.round(i/2);return e.jsx("svg",{className:`star  text-yellow-500 ${r?"filled":""}`,onMouseEnter:()=>d&&m(n),onMouseLeave:()=>d&&m(0),onClick:()=>d&&h(n*2),fill:r?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})},x)});return e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-center sm:items-end justify-center gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col items-center sm:items-end sm:flex-row gap-2 w-full",children:[e.jsx("div",{className:"text-4xl sm:text-5xl font-bold gradient-text text-center sm:text-right w-full sm:w-auto",children:t}),e.jsx("div",{className:"star-rating flex flex-row items-center justify-center sm:justify-start mt-2 sm:mt-0",children:l(t)}),e.jsxs("div",{className:"text-xs sm:text-sm dark:text-gray-400 mt-1 text-center sm:text-left w-full sm:w-auto",children:[s.toLocaleString()," ",s===1?"rating":"ratings"]})]})}),c&&e.jsxs("div",{className:"glass-card-dark p-4 rounded-lg flex flex-col items-center w-full",children:[e.jsx("h4",{className:"text-sm font-medium dark:text-gray-300 mb-2 text-center w-full",children:"Rate this movie"}),e.jsx("div",{className:"star-rating flex flex-row items-center justify-center w-full",children:l(a,!0)}),a>0&&e.jsxs("p",{className:"text-xs dark:text-gray-400 mt-2 text-center w-full",children:["You rated this ",a/2," ",a/2===1?"star":"stars"]})]})]})}const N=({review:t,onEdit:s,onDelete:g})=>{const{auth:c}=j().props,[o,m]=b.useState(!1),[a,u]=b.useState(!1),h=d=>{const p=new Date(d),n=Math.abs(new Date-p),r=Math.ceil(n/(1e3*60*60*24));return r===0?"Today":r===1?"Yesterday":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:r<365?`${Math.floor(r/30)} months ago`:`${Math.floor(r/365)} years ago`},l=t?.content&&t?.content.length>300,i=l&&!o?t?.content.substring(0,300)+"...":t?.content;return e.jsxs("div",{className:"glass-card-adaptive p-6 transition-all duration-300 hover:shadow-lg hover:scale-[1.01]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:t?.user?.avatar_url||"/images/placeholder-avatar.jpg",alt:t?.user?.name,className:"w-12 h-12 rounded-full border-2 border-gray-200 dark:border-gray-700 object-cover"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-lg text-gray-900 dark:text-white",children:t?.user?.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:h(t?.created_at)})]})]}),t?.rating&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500 dark:text-yellow-400 bg-gray-100 dark:bg-black/20 px-3 py-1 rounded-full border border-gray-200 dark:border-white/5",children:[e.jsx("span",{className:"font-bold text-lg",children:"â˜…"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-semibold",children:t?.rating}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"/10"})]})]}),t?.contains_spoilers&&!a&&e.jsx("div",{className:"mb-4 p-6 bg-yellow-50 dark:bg-yellow-500/5 border border-yellow-200 dark:border-yellow-500/20 rounded-xl backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center text-center gap-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 dark:bg-yellow-500/10 rounded-full text-yellow-600 dark:text-yellow-400",children:e.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-yellow-800 dark:text-yellow-400 font-bold text-lg mb-1",children:"Contains Spoilers"}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-400/70 text-sm mb-4",children:"This review contains spoilers."}),e.jsx("button",{onClick:()=>u(!0),className:"px-6 py-2 bg-yellow-100 hover:bg-yellow-200 dark:bg-yellow-500/20 dark:hover:bg-yellow-500/30 text-yellow-800 dark:text-yellow-400 rounded-lg font-semibold transition-colors border border-yellow-200 dark:border-yellow-500/30",children:"Reveal Review"})]})]})}),(!t?.contains_spoilers||a)&&e.jsxs("div",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-base",children:[e.jsx("p",{className:"whitespace-pre-line",children:i}),l&&e.jsxs("button",{onClick:()=>m(!o),className:"text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 text-sm mt-3 font-medium flex items-center gap-1 hover:gap-2 transition-all",children:[o?"Show less":"Read more",e.jsx("svg",{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),c.user&&c.user.id===t?.user?.id&&e.jsxs("div",{className:"flex gap-4 mt-6 pt-6 border-t border-gray-200 dark:border-white/5",children:[e.jsxs("button",{onClick:s,className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]}),e.jsxs("button",{onClick:g,className:"text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-500 dark:hover:text-red-300 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})]})};function w({value:t,onChange:s,error:g}){const[c,o]=f.useState(0),m=u=>{s&&s(u)},a=()=>[...Array(5)].map((u,h)=>{const l=h+1,i=c>0?c:t/2,d=l<=Math.ceil(i);return e.jsx("button",{type:"button",className:`star transition-transform hover:scale-110 focus:outline-none ${d?"text-yellow-500 dark:text-yellow-400":"text-gray-300 dark:text-gray-600"}`,onMouseEnter:()=>o(l),onMouseLeave:()=>o(0),onClick:()=>m(l*2),children:e.jsx("svg",{className:"w-8 h-8",fill:d?"currentColor":"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})})},h)});return e.jsxs("div",{className:"flex flex-col items-center sm:items-start gap-2",children:[e.jsx("div",{className:"flex items-center gap-1",children:a()}),t>0&&e.jsxs("span",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:[t," / 10"]}),g&&e.jsx("p",{className:"text-red-500 text-xs",children:g})]})}const S=({content:t,review:s=null,onSuccess:g,onCancel:c})=>{const{auth:o}=j().props,[m,a]=f.useState({content:s?s.content:"",rating:s?s.rating:0}),[u,h]=f.useState(!1),[l,i]=f.useState({});f.useEffect(()=>{s&&a({content:s.content,rating:s.rating})},[s]);const d=async x=>{x.preventDefault(),h(!0),i({});try{await g({id:s?.id,...m}),s||a({content:"",rating:0})}catch(n){n.response&&n.response.status===422&&i(n.response.data.errors),console.error("Submission failed",n)}finally{h(!1)}},p=(x,n)=>{a(r=>({...r,[x]:n}))};return e.jsx("form",{onSubmit:d,className:"glass-card-adaptive p-6 mb-8 transition-all duration-300 hover:shadow-lg",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:o.user.avatar_url||"/images/placeholder-avatar.jpg",alt:o.user.name,className:"w-12 h-12 rounded-full border-2 border-gray-200 dark:border-gray-700 object-cover hidden sm:block"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),s?"Edit your review":"Write a review"]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("textarea",{value:m.content,onChange:x=>p("content",x.target.value),className:"w-full bg-gray-50 dark:bg-black/20 border border-gray-200 dark:border-white/10 p-4 rounded-xl text-gray-900 dark:text-gray-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:outline-none transition-all placeholder-gray-400 dark:placeholder-gray-600 resize-y min-h-[120px]",placeholder:`What did you think of ${t.title}? Share your thoughts...`}),l.content&&e.jsxs("p",{className:"text-red-500 text-xs mt-2 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.content[0]]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(w,{value:m.rating,onChange:x=>p("rating",x),error:l.rating?l.rating[0]:null})}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx("button",{type:"button",onClick:c,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary w-full sm:w-auto px-8 py-2.5 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/40",disabled:u,children:u?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):s?"Update Review":"Submit Review"})]})]})]})]})})};export{S as R,N as a,v as b};
